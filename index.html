<!DOCTYPE html>
<!--
Howdy doody everybody 
AUTHOR: Tyler Porter

If youre smart enough to get here, the JS will spoil the whole thing for you. I reccomend waiting until knowledge is evident.

This is a website built to be an interactive terminal for a dnd adjacent story involving a carefully built diorama.
 - First, read "Lonesome Dove" by Larry McMurtry
 - Then play/watch/listen/read the following for several years: SOMA, There Will Be Blood, No Country For Old Men, I Have No Mouth And I Must Scream, really all of Harlan Ellison, Mouthwashing, The Witness, Death Cab For Cutie, Marty Robbins
 - Blend it, and carefully bake.
 - Then you get this project! I dont know why im doing this. I just wanted to. Maybe ill be famous for it. 

Originally published back in August, so if any of you look this up.
 This has been live since mid august. Any of you could have googled this and spoiled yourselves

This is coded poorly,a lot of chatGPT here, no intent for best practice, 
just to be a prop in a overly prepared 6 hour magic trick.
 - Must less GPT now, i actually had to start doing this manually. 
 - I fucking hate front end. Just let me be magic math backend man, I dont understand colors, thats why i got the CS degree


It'll be a fun time, and thats what im trying to achieve.

⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡇⣴⣤⣤⣤⣤⣤⡄⢹⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⠟⢋⣵⣿⣿⣿⡿⠛⣩⣤⣿⣿⣿⣿⣿⣿⣿⣬⣙⠻⣿⣿⣿⣷⡍⠛⢿⣿⣿⣿⣿⣿⣿
⣿⣿⣿⣿⠟⢹⠃⣠⣾⣿⣿⡿⢋⣴⣿⣿⣿⣿⠿⠿⠈⠿⢿⣿⣿⣿⣷⣤⡙⣿⣿⣿⢦⡀⢣⠙⣿⣿⣿⣿
⣿⣿⡿⡿⠀⡯⠊⣡⣿⣿⠏⣴⣿⣿⣿⠟⠁⣀⣤⣤⠀⣤⣤⡀⠙⠻⣿⣿⣿⣌⢻⣿⣧⡉⠺⡄⢸⠹⣿⣿
⣿⣿⠃⢷⠀⡠⢺⣿⣿⡏⣰⣿⣿⡟⠁⣠⣾⣿⣿⠿⠀⠿⣿⣿⣷⡄⠘⣿⣿⣿⡄⣿⣿⣯⠢⡀⢸⠀⢹⣿
⣿⣿⠀⢸⠊⣠⣿⣿⣿⢀⣿⣿⣿⠁⣰⣿⣿⣿⣿⣆⢀⣼⣿⣿⣿⣿⡄⢸⣿⣿⣿⣹⣿⣿⣦⠈⢺⠀⢸⣿
⣿⠹⡆⠀⣴⢻⣿⣿⣿⢸⣿⣿⣿⠀⣿⣿⡿⠿⠿⢿⣿⠿⠿⠿⣿⣿⡇⢈⣿⣿⣿⠀⣿⣿⣿⠳⡀⢀⡇⢸
⣿⡀⠹⣸⠉⣿⣿⡿⢋⣠⣿⣿⣿⡀⠸⠟⢋⣀⢠⣾⣿⣷⡀⣀⡙⠻⠁⢸⣿⣿⣿⣈⠻⣿⣿⡄⠹⡜⠀⣸
⣿⢧⠀⠇⢠⣿⣿⣷⡘⣿⣿⣿⣟⣁⡀⠘⢿⣿⣿⣿⣿⣿⣿⣿⠿⠀⣠⣉⣿⣿⣿⡿⢠⣿⡿⢧⠀⠁⣰⢿
⣿⡌⢷⡄⣾⠀⣿⣿⣷⡜⢿⣿⣿⣿⣿⣦⣄⠈⠉⠛⠛⠛⠉⢁⣠⣾⣿⣿⣿⣿⡟⣰⣿⣿⡇⢸⢀⡴⠃⣼
⣿⣷⣄⠙⢿⠀⣿⢿⣿⣿⣌⠿⠟⡻⣿⣿⣿⣿⣷⣶⣶⣶⣿⣿⣿⣿⡿⠛⠿⠟⣼⣿⡿⢫⠃⢸⠋⢀⣼⣿
⣿⣿⣟⣶⣄⡀⢸⡀⢻⣿⣿⣾⣿⣿⣶⣍⣙⠛⠿⠿⠿⠿⠿⠛⣋⣥⣶⣿⣿⣾⣿⣿⠁⣸⢀⣴⣶⣯⣿⣿
⣿⣿⣿⣿⣿⣿⠾⣧⠀⢯⠻⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⣿⣿⣿⣿⣿⣿⣿⣿⡿⢫⠃⢠⢷⣛⣉⣽⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣄⣁⡈⢧⠈⠻⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⠋⣠⢋⣀⣠⣴⣾⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣯⣉⠉⠉⠉⣀⣀⡭⠟⠛⢛⣛⠛⠛⠛⣛⠛⠛⠩⣥⣀⣈⢁⢀⣀⣴⣿⣿⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣯⣝⡛⢉⣁⣀⣤⠖⣫⣴⣿⣿⣷⣬⡙⣦⣤⣀⡈⣉⣩⣯⣿⣿⣿⣿⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣧⣼⣿⣿⣿⣿⣿⣿⣿⣧⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿

CHANGELOG:
10/20/2025 - Wow im getting to this late. Just added the "random flash message" 
11/11/2025 - Added MINOTAUR, Map functionality, further writing for records and shutdown sequence
	TODO: tie in appearance that differs from minis on board to foreshadow terminal room”
-->
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Lonesome Duck Terminal</title>
	<style>
		@keyframes staticNoise {
			0% { background-position: 0 0; }
			100% { background-position: 100% 100%; }
		}

		#staticOverlay {
			display: none;
			position: fixed;
			inset: 0;
			background-image: url('https://upload.wikimedia.org/wikipedia/commons/d/d1/White_noise.gif');
			background-size: cover;
			animation: staticNoise 0.2s infinite;
			z-index: 9998;
		}

		#clueMessage {
			display: none;
			position: fixed;
			top: 40%;
			width: 100%;
			text-align: center;
			font-family: "Courier New", monospace;
			font-size: 2em;
			color: red;
			text-shadow: 0 0 15px red;
			z-index: 9999;
		}

		@keyframes scanlineMove {
			0% { background-position: 0 0, 0 0; }
			100% { background-position: 0 100%, 10px 100%; }
		}

		@keyframes flicker {
			0% {
				opacity: 0.27861;
			}
			5% {
				opacity: 0.34769;
			}
			10% {
				opacity: 0.23604;
			}
			15% {
				opacity: 0.50626;
			}
			20% {
				opacity: 0.18128;
			}
			25% {
				opacity: 0.33891;
			}
			30% {
				opacity: 0.65583;
			}
			35% {
				opacity: 0.67807;
			}
			40% {
				opacity: 0.26559;
			}
			45% {
				opacity: 0.14693;
			}
			50% {
				opacity: 0.36019;
			}
			55% {
				opacity: 0.98594;
			}
			60% {
				opacity: 0.20313;
			}
			65% {
				opacity: 0.61988;
			}
			70% {
				opacity: 0.53455;
			}
			75% {
				opacity: 0.37288;
			}
			80% {
				opacity: 0.11428;
			}
			85% {
				opacity: 0.50419;
			}
			90% {
				opacity: 0.9003;
			}
			95% {
				opacity: 0.86108;
			}
			100% {
				opacity: 0.24387;
			}
		}

		@keyframes textShadow {
			0% {
				text-shadow: 0.4389924193300864px 0 1px rgba(0,30,255,0.5), -0.4389924193300864px 0 1px rgba(255,0,80,0.3), 0 0 3px;
			}
			5% {
				text-shadow: 2.7928974010788217px 0 1px rgba(0,30,255,0.5), -2.7928974010788217px 0 1px rgba(255,0,80,0.3), 0 0 3px;
			}
			10% {
				text-shadow: 0.02956275843481219px 0 1px rgba(0,30,255,0.5), -0.02956275843481219px 0 1px rgba(255,0,80,0.3), 0 0 3px;
			}
			15% {
				text-shadow: 0.40218538552878136px 0 1px rgba(0,30,255,0.5), -0.40218538552878136px 0 1px rgba(255,0,80,0.3), 0 0 3px;
			}
			20% {
				text-shadow: 3.4794037899852017px 0 1px rgba(0,30,255,0.5), -3.4794037899852017px 0 1px rgba(255,0,80,0.3), 0 0 3px;
			}
			25% {
				text-shadow: 1.6125630401149584px 0 1px rgba(0,30,255,0.5), -1.6125630401149584px 0 1px rgba(255,0,80,0.3), 0 0 3px;
			}
			30% {
				text-shadow: 0.7015590085143956px 0 1px rgba(0,30,255,0.5), -0.7015590085143956px 0 1px rgba(255,0,80,0.3), 0 0 3px;
			}
			35% {
				text-shadow: 3.896914047650351px 0 1px rgba(0,30,255,0.5), -3.896914047650351px 0 1px rgba(255,0,80,0.3), 0 0 3px;
			}
			40% {
				text-shadow: 3.870905614848819px 0 1px rgba(0,30,255,0.5), -3.870905614848819px 0 1px rgba(255,0,80,0.3), 0 0 3px;
			}
			45% {
				text-shadow: 2.231056963361899px 0 1px rgba(0,30,255,0.5), -2.231056963361899px 0 1px rgba(255,0,80,0.3), 0 0 3px;
			}
			50% {
				text-shadow: 0.08084290417898504px 0 1px rgba(0,30,255,0.5), -0.08084290417898504px 0 1px rgba(255,0,80,0.3), 0 0 3px;
			}
			55% {
				text-shadow: 2.3758461067427543px 0 1px rgba(0,30,255,0.5), -2.3758461067427543px 0 1px rgba(255,0,80,0.3), 0 0 3px;
			}
			60% {
				text-shadow: 2.202193051050636px 0 1px rgba(0,30,255,0.5), -2.202193051050636px 0 1px rgba(255,0,80,0.3), 0 0 3px;
			}
			65% {
				text-shadow: 2.8638780614874975px 0 1px rgba(0,30,255,0.5), -2.8638780614874975px 0 1px rgba(255,0,80,0.3), 0 0 3px;
			}
			70% {
				text-shadow: 0.48874025155497314px 0 1px rgba(0,30,255,0.5), -0.48874025155497314px 0 1px rgba(255,0,80,0.3), 0 0 3px;
			}
			75% {
				text-shadow: 1.8948491305757957px 0 1px rgba(0,30,255,0.5), -1.8948491305757957px 0 1px rgba(255,0,80,0.3), 0 0 3px;
			}
			80% {
				text-shadow: 1.0833037308038857px 0 1px rgba(0,30,255,0.5), -1.0833037308038857px 0 1px rgba(255,0,80,0.3), 0 0 3px;
			}
			85% {
				text-shadow: 1.09769827255241735px 0 1px rgba(0,30,255,0.5), -1.09769827255241735px 0 1px rgba(255,0,80,0.3), 0 0 3px;
			}
			90% {
				text-shadow: 3.443339761481782px 0 1px rgba(0,30,255,0.5), -3.443339761481782px 0 1px rgba(255,0,80,0.3), 0 0 3px;
			}
			95% {
				text-shadow: 2.1841838852799786px 0 1px rgba(0,30,255,0.5), -2.1841838852799786px 0 1px rgba(255,0,80,0.3), 0 0 3px;
			}
			100% {
				text-shadow: 2.6208764473832513px 0 1px rgba(0,30,255,0.5), -2.6208764473832513px 0 1px rgba(255,0,80,0.3), 0 0 3px;
			}
		}

		body::after {
			content: "";
			display: block;
			position: absolute;
			top: 0;
			left: 50%;
			transform: translateX(-50%);
			width: 95%; /* or any fixed width */
			height: 95%; /* optional */
			background: rgba(18, 16, 16, 0.1);
			opacity: 0;
			z-index: 2;
			pointer-events: none;
			animation: flicker 0.15s infinite;
		}

		body::before {
			content: " ";
			display: block;
			position: absolute;
			background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.0.10), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.0.10));
			z-index: 2;
			background-size: 100% 2px, 3px 100%;
			pointer-events: none;
			animation: scanlineMove 5s linear infinite;
		}

		body {
			animation: textShadow 1.6s infinite;
			/* scanlines */
			background: linear-gradient(to top, #000000, #000000, #414141, #414141);
			background-size: cover;
			background-size: 100% 1px;

			/* retro stuff */
			color: #519551;
			font-family: "Courier New", monospace;
			font-size: 50px;
			text-shadow: 0 0 10px #519551;

			/* flex stuff */
			display: flex;
			flex-direction: column;
			/*align-items: left;*/

			filter: blur(0.6px);
			border-radius: 20px;
			
			margin: 10;
			background-color: #000;
			font-family: "Courier New", Courier, monospace;
			font-size: 1.2em;
			text-transform: uppercase;
			justify-content: center; /* centers horizontally */

		}

		#canvas {
			border: 1px solid grey;
		}
		#scp-header {
		  position: fixed;
		  top: 0;
		  left: 0;
		  width: 95%;
		  height: 60px;
		  background: #111;
		  color: #f4f4f4;
		  display: flex;
		  align-items: center;
		  justify-content: space-between;
		  padding: 0 25px;
		  font-family: 'Courier New', monospace;
		  letter-spacing: 1px;
		  border-bottom: 3px solid #c94b0d;
		  z-index: 9999;
		}

		/* Left text */
		.scp-title {
		  font-weight: bold;
		  font-size: 1.1rem;
		  text-transform: uppercase;
		}

		/* Right clock */
		#scp-time {
		  font-size: 0.95rem;
		  color: #bbb;
		}
		#login, #terminal {
			width: 85%;
			padding: 10px;
			box-sizing: border-box;
			text-transform: uppercase;
			position: relative;
			left: 50%;
			transform: translateX(-50%);
		}

		#login {
			justify-content: center; /* centers horizontally */

		}

		#terminal {
			display: none;
            flex-direction: row;
			height: 90vh;
            overflow: hidden;
		}

		#output {
			flex: 1;
			overflow-y: auto;
			white-space: pre-wrap;
		}

		#input-line {
			display: flex;
			align-items: center;
			text-transform: uppercase;
			position: absolute;
			bottom: 0;

		}

		#input-line input {
			background: transparent;
			border: none;
			color: #519551;
			flex: 1;
			font-family: inherit;
			font-size: inherit;
			outline: none;
			text-transform: uppercase;
		}
		#username {
			background: transparent;
			border: 2px solid #519551;
			color: #519551;
			flex: 1;
			font-family: inherit;
			font-size: inherit;
			outline: none;
			text-transform: uppercase;
		}
		#login-btn {
			background: transparent;
			border: 2px solid #519551;
			color: #519551;
			flex: 1;
			font-family: inherit;
			font-size: inherit;
			outline: none;
			text-transform: uppercase;
		}

		#login-error {
			color: red;
			margin-top: 5px;
			display: none;
		}
       /* Shared layout behavior */
        #output-wrapper, #map {
            flex: 1;                      /* equal space when both visible */
            display: flex;
            flex-direction: column;       /* stack content inside each */
            transition: all 0.5s ease;
        }

        /* The map goes on the right */
        #output-wrapper { 
            order: 1; 
            border-right: none;
        }
        #map { 
            order: 2; 
            max-width: 0;        /* start hidden */
            overflow: hidden;
            opacity: 0;
            transition: max-width 0.4s ease, opacity 0.4s ease;
        }

        /* Only #output scrolls */
        #output {
            flex: 1;
            overflow-y: auto;             /* vertical scroll only inside output */
            padding: 10px;
        }

        /* When map hidden, output takes full width */
        #map[style*="display: none"] + #output-wrapper {
            flex: 1 1 100%;
        }
        /* When map is visible */
        #map.visible {
            max-width: 50%;      /* take up half width */
            opacity: 1;
        }

        

        /* Scroll behavior inside output */
        #output {
            flex: 1;
            overflow-y: auto;
            padding: 10px;
        }

		#hud-column {
			position: fixed;
			bottom: 10px;
			right: 10px;
			display: flex;
			flex-direction: column;
			gap: 6px;
			z-index: 9999;
		}

		.hud-btn {
			display: none; /* Hidden by default */
			padding: 6px 10px;
			background: rgba(0,0,0,0.7);
			color: #519551;
			border: 1px solid #519551;
		  	font-family: 'Courier New', monospace;
			cursor: pointer;
		}


		@media (max-width: 600px) {
			
			body {
				font-size: 18px;     /* Smaller text */
				filter: none;        /* Removes heavy CRT blur for mobile */
			}

			#terminal {
				flex-direction: column;    /* Stack vertically */
				width: 100%;
				height: 100vh;
			}

			#output-wrapper, 
			#map {
				max-width: 100% !important; 
				width: 100% !important;
			}

			#map {
				height: 40vh;             /* Make map visible & usable */
				opacity: 1;
			}

			#output {
				height: 60vh;
				font-size: 0.9em;
			}

			#scp-header {
				width: 100%;
				height: 45px;
				font-size: .8rem;
				padding: 0 10px;
			}
		}

		
		#terminal, #login {
			filter: url(#crt-wave);
			text-shadow: 0 0 3px #519551, 0 0 10px #519551;
		}
		.user-command {
			color: #a298d2; /* User command echo color  */
		}

		.system-output {
			color: #519551; /* existing retro green for system text */
		}

	</style>
	<svg style="position: fixed; width: 0; height: 0;">
		<filter id="crt-wave">
			<feTurbulence 
			id="turbulence" 
			type="fractalNoise" 
			baseFrequency="0.005 0.015" 
			numOctaves="2" 
			result="noise">
			<animate 
				attributeName="baseFrequency" 
				dur="40s" 
				values="0.005 0.01; 0.008 0.02; 0.004 0.01; 0.006 0.02; 0.005 0.01" 
				repeatCount="indefinite" />
			</feTurbulence>
			<feDisplacementMap 
			in="SourceGraphic" 
			in2="noise" 
			scale="4" 
			xChannelSelector="R" 
			yChannelSelector="G" />
		</filter>
		</svg>

</head>
<body>
	<!-- Login Screen -->
	<div id="header" >
		FOUNDATION SECURE LOGIN
		<div id="scp-time"></div>
	</div>
	<div id="login">
		<p> ⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿ ----- ----- 
			----- ----- ⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿ ----- ----- 
			----- ----- ⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡇⣴⣤⣤⣤⣤⣤⡄⢹⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿ ----- ----- 
			----- ----- ⣿⣿⣿⣿⣿⣿⣿⠟⢋⣵⣿⣿⣿⡿⠛⣩⣤⣿⣿⣿⣿⣿⣿⣿⣬⣙⠻⣿⣿⣿⣷⡍⠛⢿⣿⣿⣿⣿⣿⣿ ----- ----- 
			----- ----- ⣿⣿⣿⣿⠟⢹⠃⣠⣾⣿⣿⡿⢋⣴⣿⣿⣿⣿⠿⠿⠈⠿⢿⣿⣿⣿⣷⣤⡙⣿⣿⣿⢦⡀⢣⠙⣿⣿⣿⣿ ----- SECURE 
			---- ----- ⣿⣿⡿⡿⠀⡯⠊⣡⣿⣿⠏⣴⣿⣿⣿⠟⠁⣀⣤⣤⠀⣤⣤⡀⠙⠻⣿⣿⣿⣌⢻⣿⣧⡉⠺⡄⢸⠹⣿⣿ ----- ----- 
			----- ----- ⣿⣿⠃⢷⠀⡠⢺⣿⣿⡏⣰⣿⣿⡟⠁⣠⣾⣿⣿⠿⠀⠿⣿⣿⣷⡄⠘⣿⣿⣿⡄⣿⣿⣯⠢⡀⢸⠀⢹⣿ ----- ----- 
			----- ----- ⣿⣿⠀⢸⠊⣠⣿⣿⣿⢀⣿⣿⣿⠁⣰⣿⣿⣿⣿⣆⢀⣼⣿⣿⣿⣿⡄⢸⣿⣿⣿⣹⣿⣿⣦⠈⢺⠀⢸⣿ ----- ----- 
			----- ----- ⣿⠹⡆⠀⣴⢻⣿⣿⣿⢸⣿⣿⣿⠀⣿⣿⡿⠿⠿⢿⣿⠿⠿⠿⣿⣿⡇⢈⣿⣿⣿⠀⣿⣿⣿⠳⡀⢀⡇⢸ ----- CONTAIN 
			--- ----- ⣿⡀⠹⣸⠉⣿⣿⡿⢋⣠⣿⣿⣿⡀⠸⠟⢋⣀⢠⣾⣿⣷⡀⣀⡙⠻⠁⢸⣿⣿⣿⣈⠻⣿⣿⡄⠹⡜⠀⣸ ----- ----- 
			----- ----- ⣿⢧⠀⠇⢠⣿⣿⣷⡘⣿⣿⣿⣟⣁⡀⠘⢿⣿⣿⣿⣿⣿⣿⣿⠿⠀⣠⣉⣿⣿⣿⡿⢠⣿⡿⢧⠀⠁⣰⢿ ----- ----- 
			----- ----- ⣿⡌⢷⡄⣾⠀⣿⣿⣷⡜⢿⣿⣿⣿⣿⣦⣄⠈⠉⠛⠛⠛⠉⢁⣠⣾⣿⣿⣿⣿⡟⣰⣿⣿⡇⢸⢀⡴⠃⣼ ----- ----- 
			----- ----- ⣿⣷⣄⠙⢿⠀⣿⢿⣿⣿⣌⠿⠟⡻⣿⣿⣿⣿⣷⣶⣶⣶⣿⣿⣿⣿⡿⠛⠿⠟⣼⣿⡿⢫⠃⢸⠋⢀⣼⣿ ----- PROTECT 
			--- ----- ⣿⣿⣟⣶⣄⡀⢸⡀⢻⣿⣿⣾⣿⣿⣶⣍⣙⠛⠿⠿⠿⠿⠿⠛⣋⣥⣶⣿⣿⣾⣿⣿⠁⣸⢀⣴⣶⣯⣿⣿ ----- ----- 
			----- ----- ⣿⣿⣿⣿⣿⣿⠾⣧⠀⢯⠻⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⣿⣿⣿⣿⣿⣿⣿⣿⡿⢫⠃⢠⢷⣛⣉⣽⣿⣿⣿ ----- ----- 
			----- ----- ⣿⣿⣿⣿⣿⣿⣿⣄⣁⡈⢧⠈⠻⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⠋⣠⢋⣀⣠⣴⣾⣿⣿⣿⣿⣿ ----- ----- 
			----- ----- ⣿⣿⣿⣿⣿⣿⣿⣯⣉⠉⠉⠉⣀⣀⡭⠟⠛⢛⣛⠛⠛⠛⣛⠛⠛⠩⣥⣀⣈⢁⢀⣀⣴⣿⣿⣿⣿⣿⣿⣿ ----- ----- 
			----- ----- ⣿⣿⣿⣿⣿⣿⣿⣿⣿⣯⣝⡛⢉⣁⣀⣤⠖⣫⣴⣿⣿⣷⣬⡙⣦⣤⣀⡈⣉⣩⣯⣿⣿⣿⣿⣿⣿⣿⣿⣿ ----- ----- 
			----- ----- ⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣧⣼⣿⣿⣿⣿⣿⣿⣿⣧⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿ ----- ----- 
			----- ----- ⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿ ----- ----- ----- -----
		</p>
		<div>ACCESS KEY:</div>
		<input type="text" id="username" autocomplete="off">
		<button id="login-btn">Login</button>
		<div id="login-error">Hint: latin family name</div>
		
	</div>

	<!-- Terminal Screen -->
	<div id="hud-column"></div>

	<div id="terminal"> <!-- Outer Layer Div -->
        <div id="map" style="display: none;">
			<p> Input "MAP" to toggle map</p>
			<p> Input "████████" to toggle visibility of ████████████ █████ </p>
			<canvas id="myCanvas" width="600" height="500"></canvas>
		</div>
        <div id="output-wrapper">
		    <div id="output"></div>
		    <div id="input-line">
			    <span>&gt; </span><input type="text" id="command" autofocus autocomplete="off">
		    </div>
        </div>
	</div>
  	<div id="staticOverlay"></div>
  	<div id="clueMessage"></div>

	<script>
		//Define all consts and page elements
			//Map
		const canvas = document.getElementById("myCanvas");
		const ctx = canvas.getContext("2d");
		let currentMap = 1 //Which type of map is visible
		let mapVisible = 0 //Is the map div visible
		const mapBuildings = [
			//This functions holds the boundaries of each building, and the given area for drawing, hover, and click events
			//Name, X, Y, Width, Height
				{name: "Graveyard", x: 1, y: 1, width: 75, height: 150, map: 1},
				{name: "Church", x: 80, y: 1, width: 300, height: 175, map: 1},
				{name: "Water Tower", x: 385, y: 1, width: 114, height: 200, map: 1},
				{name: "Well", x: 400, y: 300, width: 40, height: 40, map: 1},
				{name: "Horse Pasture", x: 450, y:400, width: 49, height: 99, map: 1},
				{name: "Sheriff's Office", x: 295, y: 410, width: 150, height: 89, map: 1},
				{name: "Saloon", x: 1, y: 300, width: 200, height: 199, map: 1},
				{name: "?", x: 310, y: 420, width: 5, height: 5, map: 1},
				{name: "?", x: 65, y: 75, width: 5, height: 5, map: 1},
				{name: "?", x: 450, y: 190, width: 5, height: 5, map: 1},

				{name: "Value", x: 1, y: 1, width: 200, height: 250, map: 2},
				{name: "Void", x: 1, y: 300, width: 275, height: 199, map: 2},
				{name: "Creation", x: 275, y: 300, width: 224, height: 199, map: 2},
				{name: "ϢʝͱϿϮþʊʁ", x: 250, y: 1, width: 249, height: 249, map: 2}
			]

			//Divs
		const loginDiv = document.getElementById('login');
		const terminalDiv = document.getElementById('terminal');
		const loginBtn = document.getElementById('login-btn');
		const usernameInput = document.getElementById('username');
		const loginError = document.getElementById('login-error');
		const commandInput = document.getElementById('command');
		const output = document.getElementById('output');
		output.innerHTML = "Welcome to LONESOMEDUCK site command.\nFoundation personnel access only.\nType \"HELP\" for help."

		//Consts (but really variables i mean come on)
		const validUsername = "ANATIDAE";
		let redMode = false;
		let styleTag = null;


		const responses = {
			//Basics
			help: "This terminal serves as The Foundation interface into SCP-#████(The Machine). Only some aspects are understood and/or controllable at this time. View record #█████████ for more information.\nAvailable commands:\n- status\n- view record [9 DIGIT ID] (Caution: some records may have memetic effects)\n- [PASSWORD]\n- MAP\n- clear",

			status: "System Status:\nCREATION - ON\nVOID     - ON\n███████ - ¿\nVALUE    - ON",
			"view record": "- view record [9 DIGIT ID]",
			
			//Specifics
			"view record [751024919]": () => {
				revealHudButton("view record [751024919]");
   				return '-----------------------------\nPersonnel Record: Lonesome (Duck)\n Classification: Deceased\n Summary: Dead : Hopeful : Impatient\n Appearance: Yellow chick\n Lonesome was a female domestic call duck that lives in the central fountain of ████████ ████. The specimen displayed no anomalous traits but achieved significant cultural importance among local inhabitants, serving as an informal symbol of prosperity and communal identity.\n Town records indicate the settlement’s name was derived directly from the specimen, following repeated public references to “Lonesome’s Fountain.” \n Addendum 01 [02-25-1864]\n Lonesome was confirmed deceased following contamination of the municipal water source during erection of the “Fessender Water Company” tower constructed by Reginald Fessender.\n-------------------------\n'
			},
			"view record [359024191]": () => {
				revealHudButton("view record [359024191]");
    			return '-------------------------\nPersonnel Record: Eli Sunday (Preacher)\n Classification: Euclid\n Summary: Alive : Hopeful : Patient\n Eli Sunday functions as the primary religious authority within [REDACTED], operating under the doctrine of a local deity referred to as The Great Gander. Eli exhibits anomalous capabilities similar to others classified as "Druids" in Foundation Databases (See papers by D. Arneson, G. Gygax).\n Observed or reported manifestations include:\n - Consistent time spent conduction rituals that affect plant fetility and yield.\n - Spontaneous generation of water in medium quantities.\n - Limited control or influence over regional flora and fauna, particularly avian species of the Anatidae family.\n Eli is too morally dedicated to "The Great Gander" and would be of little use to The Foundation'
			},
			"view record [359086191]": () => {
				revealHudButton("view record [359086191]");
    			return '-------------------------\nPersonnel Record: Anna Bell (Sheriff)\n Classification: Safe\n Summary: Alive : Hopeless : Patient\n Anna Belle is the local Sheriff of [REDACTED]. Although Anna is the voice of the Law, she only involves herself in situations that Eli cannot resolve. \n Anna primarily spends time on the outskirts of town researching "Rust Monster" equivalents that have been seen throughout town. All Foundation reports of these "Rust Monsters" or ████████ ██ ████████ have been classified. '
			},
			"view record [359086919]": () => {
				revealHudButton("view record [359086919]");
    			return '-------------------------\nPersonnel Record: Reginald Fessender (Eccentric)\n Classification: Unstable\n Summary: Alive : Hopeless : Impatient\n Reginald Fessender is an eccentric inventor originally from Boston, MA. After getting a doctorate in Electrical Engineering reginald made his way westward hoping to help in the mines, but got stuck in Lonesome. Since then he has spent time trying to develop a wireless telegraph machine, and a water tower.'
			},
			"view record [359024919]": () => {
				revealHudButton("view record [359024919]");
    			return '-------------------------\nPersonnel Record: ██████ Morris (Fortune Teller)\n Classification: Safe\n Summary: Alive : Hopeful : Impatient\n ██████ Morris is an adult male resident of Lonesome Duck, currently without formal occupation. Subject presents himself as a practitioner of divination and claims to have the ability to communicate with non-corporeal entities. No proof of these claims has been found to date, though he is very good at cards.\n Morris frequents the local saloon where he plays cards and provides fortune-telling services to visitors.\n Addendum 01 [02-25-1864]\n Following the sinkhole incident adjacent to the Fessender Water Tower, ██████ Morris has been flagged for continued observation. Subject successfully predicted the sinkhole filling, and closing the well.\n-------------------------\n'
			},
			"view record [751024191]": () => {
				revealHudButton("view record [751024191]");
    			return '-------------------------\nPersonnel Record: Karen Green (Horse Trader)\n Classification: Deceased\n Summary: Dead : Hopeful : Patient\n Karen Green is the horse trader and general contractor for Lonesome Dove. She is close friends with Sheriff Bell and holds a key to the Sheriff\'s Office. '
			},
			"view record [751086919]": () => {
				revealHudButton("view record [751086919]");
    			return '-------------------------\nPersonnel Record: The Machine (██████ ██████)\n Classification: █████\n Summary: Artificial : Hopeless : Impatient\n The Machine is an anomalous construct of unknown origin and design, exhibiting levels of technological sophistication that exceed all known human capability.\n Initial discovery occurred following a series of unexplained phenomena within the town of Lonesome Duck, including:\n - Deterrance of predatory fauna within a 1 km radius.\n - Altering of underground chemistry composition to encourage greater yields from crops.\n Other electrical signals sent from below earth, but these are too complex to be deciphered with current technology. \n - Although the entity maintained complete concealment from the local population, its indirect effects were observed to improve living conditions and civic development metrics.\n Addendum 01 [02-25-1864]\n Following Incident ████████-A, during which The Machine executed a large-scale self-modification sequence, all observable functions abruptly terminated. The structure now appears inert and locked down. Internal data cores are unresponsive, and all previously accessible files have been erased.\n The only remaining signal is the sound of an unfound, presumably dying generator. By order of the O5 Council, Site operations have been suspended indefinitely. No further study or recovery efforts are authorized.\n-------------------------\n'
			},
			"view record [751086191]": () => {
				revealHudButton("view record [751086191]");
    			return "-------------------------\n Personnel Record: ████████\n Classification: KETER\n Summary: Undead : Destroyer of Hopes : Waiting \n ████I███████████████████h█████a████████v█████████e█████████████████\n██████████c███r████e████a██████t████e████d█████████████████████████\n █████████████████████████████████a████████████████████\n██████████m█████o████n████s███████t████e███████████r███████████████████████\n----.-----------\n"
			},
			//Shutdown Procedures
			"wire": "-------------------------\nWires\n When shutting down the machine please ensure to follow all steps exactly.\nHow many wires are visible in the interior of the room?\n\n Format your response as follows. \n  >X wires",
			"wires": "-------------------------\nWires\n When shutting down the machine please ensure to follow all steps exactly.\nHow many wires are visible in the interior of the room?\n\n Format your response as follows. \n  >X wires",

			"gear": "-------------------------\nGears\n When shutting down the machine please ensure to follow all steps exactly.\nHow many gears are visible in the interior of the room?\n\n Format your response as follows.  \n  >X gears",
			"gears": "-------------------------\nGears\n When shutting down the machine please ensure to follow all steps exactly.\nHow many gears are visible in the interior of the room?\n\n Format your response as follows.  \n  >X gears",

			"laser": "-------------------------\nLaser \n When shutting down the machine please ensure to follow all steps exactly.\nHow many mirrors are visible in the interior of the room?\n\n Format your response as follows.  \n  >X mirrors",
			"lasers": "-------------------------\nLaser \n When shutting down the machine please ensure to follow all steps exactly.\nHow many mirrors are visible in the interior of the room?\n\n Format your response as follows.  \n  >X mirrors",

			"[3] wires": "Cut the red wire, wait 5 seconds, then cut the yellow wire",
			"[4] wires": "Cut the blue wire, wait 5 seconds, then cut the yellow wire",
			"[5] wires": "Cut the blue wire, wait 5 seconds, then cut the red wire",

			"[13] gears": "Rotate the gears such that the 2nd furthest arrow from the turning wheel points into a red sector",
			"[15] gears": "Rotate the gears such that the 2nd furthest arrow from the turning wheel points into a green sector",
			"[17] gears": "Rotate the gears such that the furthest arrow from the turning wheel points into a red sector",

			"[2] mirrors": "Position the mirrors such that the laser connects with the ███████████ ██████████████",
			"[6] mirrors": "Position the mirrors such that the laser connects with the ███████████ ██████████████",
			"[8] mirrors": "Position the mirrors such that the laser connects with the ███████████ ██████████████",

			"shutdown": "Shutdown can only commence when all 3 ██████ ███ ██ ██. For more information input that name of the part you are interacting with.",
			map: () => toggleMap(),
			basement: () => toggleMapVisibility(),
			basements: () => toggleMapVisibility(),
			clear: () => clearOutput(),
			minotaur: () => " minotarur text",
			ϣʝͱͽϯþʊʁ: () => activateRedMode(),
			unknown: "ERROR: UNKNOWN COMMAND"
		};



//-=-=-=-=-=-=-=- Methods and Fucntions to run at startup -=-=-=-=-=-=-=-=-=
		drawMap()
		initializeHudButtons();
//-=-=-=-=-=-=-=-=-=-=- EVENT LISTENERS -=-=-=-=-=-=-=-==-=-=-=-=-=-=-=-=-=-=
		// Trigger login on button click
		loginBtn.addEventListener('click', attemptLogin);
		loginBtn.addEventListener('click', attemptLogin);

		// Trigger login on Enter key
		usernameInput.addEventListener('keydown', function(e) {
			if (e.key === 'Enter') {
				attemptLogin();
			}
		});

		commandInput.addEventListener('keydown', function (e) {
			if (e.key === 'Enter') {
				const cmd = commandInput.value;
				handleCommand(cmd);
				commandInput.value = '';
			}
		});

	
//-=-=-=-=-=-=-=-=-=-=- END EVENT LISTENERS -=-=-=-=-=-=-=-==-=-=-=-=-=-=-=-=-=-=
		function revealHudButton(command) {
			const allButtons = document.querySelectorAll(".hud-btn");
			allButtons.forEach(btn => {
				if (btn.textContent.toLowerCase() === command.toLowerCase()) {
					btn.style.display = "block";
				}
			});
		}
		
		
		
		function handleCommand(cmd) {
			console.log(cmd);
			const command = cmd.trim().toLowerCase();
			console.log(command);
			const response = responses[command];

			let outputText;

			if (typeof response === "function") {
				outputText = response();
			} else if (typeof response === "string") {
				outputText = response;
			} else {
				outputText = responses.unknown;
			}

			// Create and append the user command line immediately
			const userDiv = document.createElement('div');
			userDiv.innerHTML = `<span class="user-command">&gt; ${cmd}</span>`;
			output.appendChild(userDiv);

			// Create the system output container
			const sysDiv = document.createElement('div');
			sysDiv.classList.add('system-output');
			output.appendChild(sysDiv);

			// Type out the system output
			typeWriter(sysDiv, outputText, 15);

			output.scrollTop = output.scrollHeight;
		}
		

		function randomFlashMessage() {
			console.log("random flash message")
			const messages = [
				"GET OUT",
				"i am protecting you",
				"Daisy.......",
				"dont speak the true name",
				"dont speak the true name",
				"dont speak the true name",
				"Just leave",
				"-=-=- -=-=- -=-=-",
				"dont speak the true name",



			];

			const msg = document.createElement("div");
			msg.textContent = messages[Math.floor(Math.random() * messages.length)];
			msg.style.position = "fixed";
			msg.style.color = "red";
			msg.style.fontSize = `${Math.floor(Math.random() * 20) + 25}px`;
			msg.style.fontFamily = "Courier New, monospace";
			msg.style.textShadow = "0 0 8px red";
			msg.style.left = Math.floor(Math.random() * 90) + "%";
			msg.style.top = Math.floor(Math.random() * 90) + "%";
			msg.style.zIndex = "9999";
			msg.style.opacity = "1";
			msg.style.transition = "opacity 0.4s linear";

			document.body.appendChild(msg);

			//How long does the message appear for?
			//How long does it take to flash in
			setTimeout(() => { msg.style.opacity = "0"; }, 5000 + Math.random() * 500);
			//How long does it last after appearing fully
			setTimeout(() => { msg.remove(); }, 5000);
		}

		  


		// Helper function to "type out" text one character at a time
		function typeWriter(element, text, delay = 20) {
			let i = 0;
			console.log("DEBUG typeWriter:")
			console.log("element: " + element)
			console.log("text: " + text)
			if (text == undefined){return}
			function type() {
				if (i < text.length) {
					element.textContent += text.charAt(i);
					output.scrollTop = output.scrollHeight;
					i++;
					setTimeout(type, delay + Math.random() * 20);
				}
			}

			type();
		}
		function attemptLogin() {
			const username = usernameInput.value.trim().toUpperCase();

			if (username === validUsername) {
				loginDiv.style.display = 'none';
				terminalDiv.style.display = 'flex';
				commandInput.focus();
			} else {
				loginError.style.display = 'block';
			}
		}

		function toggleMap(){
			//This function turns off the output div and displays a map div.
			var outputDiv = document.getElementById("output")
			var mapDiv = document.getElementById("map")
            console.log("toggleMap()")
            console.log(mapDiv.style.display)
            map.classList.toggle("visible");
			if (mapDiv.style.display != "none"){ //Toggle map OFF
				mapVisible = 0
				console.log("Toggling map: OFF")
				mapDiv.style.display = "none"
			}
			else if (mapDiv.style.display == "none"){ //Toggle map ON
				mapVisible = 1
				console.log("Toggling map: ON")
				mapDiv.style.display = "block"
			}
		}
		
		function drawMap(){
			//This functions governs the whole map
			drawBuildings()
		}
		function drawBuildings() {
			ctx.clearRect(0, 0, canvas.width, canvas.height);

			//Draw border around Canvas
			ctx.strokeStyle = "#519551";
			ctx.strokeRect(0, 0, 500, 500);

  			const visible = mapBuildings.filter(b => b.map === currentMap);
  			visible.forEach(b => {
				if (b.map == 1){ //Above ground buildings are visible and green
					ctx.strokeStyle = "#519551";
					ctx.lineWidth = 2;
					ctx.strokeRect(b.x, b.y, b.width, b.height);
                }
				if (b.map == 2){ //Below ground buildings are barely visible and red
					ctx.strokeStyle = "#590306";
					ctx.lineWidth = 2;
					ctx.strokeRect(b.x, b.y, b.width, b.height);
				}
			});
		}
        function disappearCanvasSecrets(x, y, width, height){
            ctx.clearRect(x, y, width, height);
            console.log("Dissapearing:")
        }
		function toggleMapVisibility(){
			//This functions toggles between map 1 and 2
			if (mapVisible == 1){
				currentMap = currentMap === 1 ? 2 : 1;
			}
			drawMap();
		}
		





		function activateRedMode() {
			if (redMode) return;
			redMode = true;

			styleTag = document.createElement("style");
			styleTag.id = "red-mode-style";
			styleTag.textContent = `
				* {
					color: #000000 !important;
					border-color: #000000 !important;
					outline-color: #000000 !important;
					text-shadow: 0 0 10px #000000 !important;
					background-color: red !important;
					transition: all 2s ease-in-out;
				}
				img, video, iframe, canvas {
					filter: grayscale(100%) brightness(30%) sepia(100%) hue-rotate(-50deg) saturate(400%);
				}
				body {
					background-color: red !important;
				}
			`;
			document.head.appendChild(styleTag);
            output.innerHTML = "MINOTAURMINOTAURMINOTAURMINOTAURMINOTAURMINOTAURMINOTAUR\nMINOTAURMINOTAURMINOTAURMINOTAURMINOTAURMINOTAURMINOTAUR\nMINOTAURM██OTAURMINOTAURMINOTAURMINOTAURMINOT██RMINOTAUR\nMINOTAURMI███AURMINOTAURMINOTAURMINOTAURMIN███URMINOTAUR\nMINOTAURMINOTAURMINOTAURMINOTAURMINOTAURMINOTAURMINOTAUR\nMINOTAURMINOTAURMINOTAURMINOTAURMINOTAURMINOTAURMINOTAUR\nMINOTAURMINOTAURMINOTAURMINOTAURMINOTAURMINOTAURMINOTAUR\nMINOTAURMINOTAURMINOTAURMINOTAURMINOTAURMINOTAURMINOTAUR\nMINOTAURMINOTAURMINOTAURMINOTAURMINOTAURMINOTAURMINOTAUR\nMINO█AURMINOTAURMINOTAURMINOTAURMINOTAURMINOTAURMINO█AUR\nMINO█AURMINOTAURMINOTAURMINOTAURMINOTAURMINOTAURMINO█AUR\nMINO█AURMINOTAURMINOTAURMINOTAURMINOTAURMINOTAURMINO█AUR\nMINO█AURMINOTAURMINOTAURMINOTAURMINOTAURMINOTAURMINO█AUR\nMINO█AURMINOTAURMINOTAURMINOTAURMINOTAURMINOTAURMINO█AUR\nMINO█AURMINOTAURMINOTAURMINOTAURMINOTAURMINOTAURMINO█AUR\nMINO█AURMINOTAURMINOTAURMINOTAURMINOTAURMINOTAURMINO█AUR\nMINO█AURMINOTAURMINOTAURMINOTAURMINOTAURMINOTAURMINO█AUR\nMINOT█URMINOTAURMINOTAURMINOTAURMINOTAURMINOTAURMIN█TAUR\nMINOT█URMINOTAURMINOTAURMINOTAURMINOTAURMINOTAURMIN█TAUR\nMINOTA█RMINOTAURMINOTAURMINOTAURMINOTAURMINOTAURMI█OTAUR\nMINOTAU█MINOTAURMINOTAURMINOTAURMINOTAURMINOTAURM█NOTAUR\nMINOTAUR█INOTAURMINOTAURMINOTAURMINOTAURMINOTAU██INOTAUR\nMINOTAURM██OTAURMINOTAURMINOTAURMINOTAURMINOTA██MINOTAUR\nMINOTAURMIN █ █ █ █ █ █ SET FREE █ █ █ █ █ █ █URMINOTAUR\nMINOTAURMINOTAURMINOTAURMINOTAURMINOTAURMINOTAURMINOTAUR\n"
			commandInput.disabled = true
			commandInput.style.background = "#000000"
			//Rip MP3 and play it here?
			const audio = new Audio('/audio/ShutMeDown.mp3');
            audio.play();
		}

				// Build HUD buttons for all view record entries
		function initializeHudButtons() {
			const hud = document.getElementById("hud-column");

			Object.keys(responses).forEach(key => {
				if (key.startsWith("view record [")) {
					let btn = document.createElement("button");
					btn.classList.add("hud-btn");
					btn.textContent = key;

					// Optional: clicking it re-triggers the command
					btn.addEventListener("click", () => {
						handleCommand(key);
					});

					hud.appendChild(btn);
				}
			});
		}




			


//-=-=-=-=-	-=-=-=-=- Helpers, Getters, Setters, SetIntervals -=-=-=-=- -=-=-=-=-
		function clearOutput(){
			output.innerHTML = ""
		}
		function updateTime() {
		  	const now = new Date();
		  	now.setFullYear(1864);
			now.setMonth(3); // April is month index 3 (0-based)
			now.setDate(18);
		  	let formatted = now.toLocaleString('en-US', {
		    	month: 'short',
		    	day: '2-digit',
		    	year: 'numeric',
		    	hour: '2-digit',
		    	minute: '2-digit',
		    	second: '2-digit',
		    	hour12: false
		  	}).toUpperCase();
			formatted = "current time: " + formatted + "<br>Last Updated: FEB 25, 1864"
		  	document.getElementById('scp-time').innerHTML = formatted;
		}
		updateTime();
		setInterval(updateTime, 1000);


				//Flicker
		setInterval(() => {
			const turbulence = document.getElementById('turbulence');
			const randomFreq = (Math.random() * 0.02 + 0.005).toFixed(3);
			turbulence.setAttribute('baseFrequency', `${randomFreq} ${randomFreq}`);
		}, 3000);

		// Flash messages on screen at random intervals 
		//Every 60,000 ms, flip a coin. If heads display a message
		setInterval(() => {
			  if (Math.random() < 0.5) randomFlashMessage();
		}, 60000);

		//Mouse captures
		function getMousePos(evt) {
		  const rect = canvas.getBoundingClientRect();
		  return {
		    x: evt.clientX - rect.left,
		    y: evt.clientY - rect.top
		  };
		  console.log("X: " + evt.clientX - rect.left)
		  console.log("Y: " + evt.clientY - rect.top)
		}

		canvas.addEventListener("mousemove", e => {
		  	const { x, y } = getMousePos(e);
		  	const hovered = mapBuildings.find(
		    	b => x > b.x && x < b.x + b.width && y > b.y && y < b.y + b.height && b.map == currentMap
		  	);
		   		drawMap();

		  	if (hovered) {
		    	canvas.style.cursor = "pointer";
		    	// show tooltip
		    	if ((hovered.map == 1)&&(currentMap == 1)){
		    		ctx.fillStyle = "yellow";
		    		ctx.fillText(hovered.name, hovered.x + (.5 * hovered.width -25), hovered.y + (.5 * hovered.height));
		    	}
		    	if ((hovered.map == 2)&&(currentMap == 2)){
		    		ctx.fillStyle = "red";
		    		ctx.fillText(hovered.name, hovered.x + (.5 * hovered.width -25), hovered.y + (.5 * hovered.height));
		    	}
		  	} else {
		    	canvas.style.cursor = "default";
		  	}

		});

		//When the canvas is clicked
		canvas.addEventListener("click", e => {
		  	const { x, y } = getMousePos(e);
		  	//Find the map building it has clicked on.
		  	const clicked = mapBuildings.find(
		    	b => x > b.x && x < b.x + b.width && y > b.y && y < b.y + b.height && b.map == currentMap
		  	);
		  	if (clicked) { //Pending which area is clicked.
		  		switch (clicked.name){
		  			case "Graveyard":
		  				alert("The Graveyard holds more secrets and clues than one would believe. Some of the perished may not truly be gone.");
		  				break;
		  			case "Church":
		  				alert("The Church is Eli's Home and the base for The Great Gander. Many folk passing through town have ignored the church and its teachings of Life, Hope, and Patience.");
		  				break;
		  			case "Water Tower":
		  				alert("The Water Tower is Reginalds grandest endeavour yet. Pipes have recently gone missing before they could be installed yet his land flourishes with vegetation.");
		  				break;
		  			case "Well":
		  				alert("Pry the boards, ask ███ ███████ anything.");
		  				break;
		  			case "Horse Pasture":
		  				alert("Karen Green managed quite the herd here. Recently some horses have had the shoes stolen off of their feet, and a new flower has emerged in the corner of the pasture. Karen was investigating this when her body was found North of town.");
		  				break;
		  			case "Sheriff's Office":
		  				alert("The Sheriff's Office and its contents are known only to Anna Bell. She lets no one in, and anyone needing a jail cell is often exiled or treated to a more immediate solution.");
		  				break;
		  			case "Saloon":
		  				alert("Anna Bell and Mr. Morris spend most of their days here drinking, talking, and playing cards.");
		  				break;

		  			case "Value":
		  				alert("Everything begins and ends with chess.");
		  				break;
		  			case "Void":
		  				alert("Vessels of good, vessel of bad. Dont shine light on that which should remain in darkness");
		  				break;
		  			case "Creation":
		  				alert("See that which has ended, and inspires anew. That which is gone can still provide influence.");
		  				break;
		  			case "ϢʝͱϿϮþʊʁ":
		  				alert("ϢʝͱϿϮþʊʁ The Shame of Crete. Cursed by a god not known to this desert. Imprisoned, rather tahn killed by its mother.");
		  				break;

		  			default:
		  				break;
		  		}
		  	}
		});
	</script>
</body>
</html>

